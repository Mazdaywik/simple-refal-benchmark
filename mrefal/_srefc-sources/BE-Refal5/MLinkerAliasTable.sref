$EXTERN BED_Refal5P_MLinkerAliasTableP_Lookup;
$ENUM BED_Refal5P_MLinkerAliasTableP_AliasTable;
BED_Refal5P_MLinkerAliasTableP_LookupD_HashedD_AddNew {
  t.Num (e.Name )(e.Alias )s.Hash e.HashGroupD_B (s.Hash e.Aliases )e.HashGroupD_E =
    <BED_Refal5P_MLinkerAliasTableP_Lookup [BED_Refal5P_MLinkerAliasTableP_AliasTable t.Num (s.Hash (e.Name (e.Alias ))e.Aliases )e.HashGroupD_B e.HashGroupD_E ]e.Name s.Hash >;
  t.Num (e.Name )(e.Alias )s.Hash e.HashGroups =
    <BED_Refal5P_MLinkerAliasTableP_Lookup [BED_Refal5P_MLinkerAliasTableP_AliasTable t.Num (s.Hash (e.Name (e.Alias )))e.HashGroups ]e.Name s.Hash >;
}

BED_Refal5P_MLinkerAliasTableP_CategChar {
  'Index' =
    'i' ;
  'Local' =
    'L' ;
  'Entry' =
    'E' ;
  'Swap' =
    'S' ;
  'Ident' =
    'W' ;
  'ADT' =
    'T' ;
}

$FORWARD BED_Refal5P_MLinkerAliasTableP_NewAliasAux;
BED_Refal5P_MLinkerAliasTableP_NewAlias {
  t.Num e.CategStr '::' e.Name =
    <BED_Refal5P_MLinkerAliasTableP_NewAliasAux <BED_Refal5P_MLinkerAliasTableP_CategChar e.CategStr >t.Num e.CategStr '::' e.Name >;
}

$FORWARD BED_Refal5P_MLinkerAliasTableP_NewAliasAuxWithNumber;
$FORWARD BED_Refal5P_MLinkerAliasTableP_IncCateg;
BED_Refal5P_MLinkerAliasTableP_NewAliasAux {
  s.CategChar t.Num e.NameInRout =
    <BED_Refal5P_MLinkerAliasTableP_NewAliasAuxWithNumber s.CategChar <BED_Refal5P_MLinkerAliasTableP_IncCateg t.Num s.CategChar >(e.NameInRout )>;
}

BED_Refal5P_MLinkerAliasTableP_NewAliasAuxWithNumber {
  s.CategChar t.Num e.AliasNumber (e.NameInRout )=
    t.Num (e.NameInRout )(s.CategChar e.AliasNumber );
}

$FORWARD BED_Refal5P_MLinkerAliasTableP_IncStringIndex;
BED_Refal5P_MLinkerAliasTableP_IncCateg {
  (e.NumsD_B (s.Categ e.Num )e.NumsD_E )s.Categ =
    ((s.Categ <BED_Refal5P_MLinkerAliasTableP_IncStringIndex e.Num >)e.NumsD_B e.NumsD_E )e.Num ;
  (e.Nums )s.Categ =
    <BED_Refal5P_MLinkerAliasTableP_IncCateg ((s.Categ )e.Nums )s.Categ >;
}

$FORWARD BED_Refal5P_MLinkerAliasTableP_IncStringIndexAux;
$FORWARD BED_Refal5P_MLinkerAliasTableP_CharDigitsSeq;
BED_Refal5P_MLinkerAliasTableP_IncStringIndex {
  e.Num =
    <BED_Refal5P_MLinkerAliasTableP_IncStringIndexAux (e.Num )<BED_Refal5P_MLinkerAliasTableP_CharDigitsSeq >>;
}

BED_Refal5P_MLinkerAliasTableP_CharDigitsSeq {
  =
    '0123456789' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' ;
}

BED_Refal5P_MLinkerAliasTableP_IncStringIndexAux {
  (s.Last )s.Zero s.First e.Seq s.Last =
    s.First s.Zero ;
  (e.Num s.Last )s.Zero e.Seq s.Last =
    <BED_Refal5P_MLinkerAliasTableP_IncStringIndexAux (e.Num )s.Zero e.Seq s.Last >s.Zero ;
  (e.Num s.Last )e.SeqD_B s.Last s.Next e.SeqD_E =
    e.Num s.Next ;
  ()s.First e.SeqD_E =
    s.First ;
}

$EXTERN MOrderP_Sort;
$FORWARD BED_Refal5P_MLinkerAliasTableP_Code;
BED_Refal5P_MLinkerAliasTableP_SortAliases {
  e.HashGroups =
    <MOrderP_Sort <BED_Refal5P_MLinkerAliasTableP_Code e.HashGroups >>;
}

$FORWARD BED_Refal5P_MLinkerAliasTableP_CodeD_HashGroup;
BED_Refal5P_MLinkerAliasTableP_Code {
  (s.Hash e.Items )e.HashGroups =
    <BED_Refal5P_MLinkerAliasTableP_CodeD_HashGroup e.Items ><BED_Refal5P_MLinkerAliasTableP_Code e.HashGroups >;
  =
    ;
}

$FORWARD BED_Refal5P_MLinkerAliasTableP_LengthD_T;
BED_Refal5P_MLinkerAliasTableP_CodeD_HashGroup {
  ('Index::' e.Name ('i' e.Index ))e.Items =
    <BED_Refal5P_MLinkerAliasTableP_CodeD_HashGroup e.Items >;
  (e.Name (s.Categ e.Index ))e.Items =
    (s.Categ <BED_Refal5P_MLinkerAliasTableP_LengthD_T e.Index >(e.Name ))<BED_Refal5P_MLinkerAliasTableP_CodeD_HashGroup e.Items >;
  =
    ;
}

$EXTERN MStringsP_LengthD_T;
BED_Refal5P_MLinkerAliasTableP_LengthD_T {
  s.1 =
    1 s.1 ;
  s.1 s.2 =
    2 s.1 s.2 ;
  s.1 s.2 s.3 =
    3 s.1 s.2 s.3 ;
  e.Index =
    <MStringsP_LengthD_T e.Index >;
}

$EXTERN MFileIOP_WriteLine;
$EXTERN MFileIOP_Close;
BED_Refal5P_MLinkerAliasTableP_UserTypeAliases {
  t.FAli (s.CategChar s.Length e.Alias (e.CategStr '::' e.Name ))e.Tail =
    <BED_Refal5P_MLinkerAliasTableP_UserTypeAliases <MFileIOP_WriteLine t.FAli s.CategChar e.Alias ' --> ' e.Name >e.Tail >;
  t.FAli =
    <MFileIOP_Close t.FAli >;
}

$ENTRY BED_Refal5P_MLinkerAliasTableP_Create {
  =
    [BED_Refal5P_MLinkerAliasTableP_AliasTable ()];
}

$ENTRY BED_Refal5P_MLinkerAliasTableP_Lookup {
  [BED_Refal5P_MLinkerAliasTableP_AliasTable t.Num e.HashGroupD_B (s.Hash e.AliasesD_B (e.Name (e.Alias ))e.AliasesD_E )e.HashGroupD_E ]e.Name s.Hash =
    [BED_Refal5P_MLinkerAliasTableP_AliasTable t.Num (s.Hash (e.Name (e.Alias ))e.AliasesD_B e.AliasesD_E )e.HashGroupD_B e.HashGroupD_E ]e.Alias ;
  [BED_Refal5P_MLinkerAliasTableP_AliasTable t.Num e.HashGroups ]e.Name s.Hash =
    <BED_Refal5P_MLinkerAliasTableP_LookupD_HashedD_AddNew <BED_Refal5P_MLinkerAliasTableP_NewAlias t.Num e.Name >s.Hash e.HashGroups >;
}

$ENTRY BED_Refal5P_MLinkerAliasTableP_AddBuiltIn {
  [BED_Refal5P_MLinkerAliasTableP_AliasTable t.Num e.HashGroupD_B (s.Hash e.Aliases )e.HashGroupD_E ](e.Name s.Hash )e.RealName =
    [BED_Refal5P_MLinkerAliasTableP_AliasTable t.Num (s.Hash e.Aliases (e.Name (e.RealName )))e.HashGroupD_B e.HashGroupD_E ];
  [BED_Refal5P_MLinkerAliasTableP_AliasTable t.Num e.HashGroups ](e.Name s.Hash )e.RealName =
    [BED_Refal5P_MLinkerAliasTableP_AliasTable t.Num (s.Hash (e.Name (e.RealName )))e.HashGroups ];
}

$EXTERN MFileIOP_Open;
$ENTRY BED_Refal5P_MLinkerAliasTableP_OutAliasesD_D {
  [BED_Refal5P_MLinkerAliasTableP_AliasTable t.Num e.Aliases ]e.TargetFileName =
    <BED_Refal5P_MLinkerAliasTableP_UserTypeAliases <MFileIOP_Open 'w' e.TargetFileName '-Aliases.txt' ><BED_Refal5P_MLinkerAliasTableP_SortAliases e.Aliases >>;
}

BED_Refal5P_MLinkerAliasTableP_FinalizeE_ {
  =
    ;
}

$EXTERN RegisterE_;
$ENTRY BED_Refal5P_MLinkerAliasTableP_EntryPointE_ {
  =
    <RegisterE_ BED_Refal5P_MLinkerAliasTableP_FinalizeE_ >;
}

